"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[969],{37969:(U,p,s)=>{s.r(p),s.d(p,{ProfileModule:()=>T});var d=s(69808),f=s(84490),g=s(70655),o=s(93075),c=s(72986),e=s(5e3),u=s(38920),_=s(28675),h=s(88037);function v(n,i){1&n&&(e.\u0275\u0275elementStart(0,"span",22),e.\u0275\u0275text(1,"\u2304"),e.\u0275\u0275elementEnd())}function C(n,i){1&n&&(e.\u0275\u0275elementStart(0,"span",23),e.\u0275\u0275text(1,"^"),e.\u0275\u0275elementEnd())}function w(n,i){if(1&n&&(e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275elementStart(1,"label",27),e.\u0275\u0275text(2,"Confirm your password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"input",32),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("for",t.formCtrl),e.\u0275\u0275advance(2),e.\u0275\u0275property("id",t.formCtrl)}}function y(n,i){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",24),e.\u0275\u0275elementStart(1,"form",25),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext(2),a=e.\u0275\u0275reference(19);return l.onSubmit(a)}),e.\u0275\u0275elementStart(2,"div",26),e.\u0275\u0275elementStart(3,"label",27),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,w,4,2,"div",29),e.\u0275\u0275elementStart(7,"button",30),e.\u0275\u0275text(8,"Enregistrer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",r.inputForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("for",t.formCtrl),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("Enter the new ",t.formCtrl,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("type","password"==t.formCtrl?"password":"numeroTelephone"===t.formCtrl?"number":"text")("id",t.formCtrl)("formControlName",t.formCtrl),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","password"==t.formCtrl),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",r.inputForm.invalid)}}const x=function(n){return{"margin-top":n}};function b(n,i){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",16),e.\u0275\u0275elementStart(1,"div",17),e.\u0275\u0275elementStart(2,"div"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",18),e.\u0275\u0275listener("click",function(){const a=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275nextContext().toggleDisplay(a)}),e.\u0275\u0275template(5,v,2,0,"span",19),e.\u0275\u0275template(6,C,2,0,"span",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,y,9,8,"div",21),e.\u0275\u0275elementEnd()}if(2&n){const t=i.$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,x,t.displayed?"-.5rem":"-1.1rem")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.displayed),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displayed),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displayed)}}function P(n,i){1&n&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275elementStart(1,"h2",39),e.\u0275\u0275text(2,"Un moment s'il vous plait ..."),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"div",40),e.\u0275\u0275elementEnd())}function S(n,i){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",41),e.\u0275\u0275elementStart(1,"h2"),e.\u0275\u0275text(2,"Vous devez entrer votre mot de passe pour pouvoir continuer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p"),e.\u0275\u0275text(4,"Cette action n\xe9cissite votre Mot de passe"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"label",42),e.\u0275\u0275text(6,"Mot de passe"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"input",43),e.\u0275\u0275listener("ngModelChange",function(l){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext(2).pswd=l}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"a",44),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext(2),a=e.\u0275\u0275reference(19);return l.file?l.uploadPic():l.onSubmit(a)}),e.\u0275\u0275text(9,"Continuer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(7),e.\u0275\u0275property("ngModel",t.pswd)}}function M(n,i){if(1&n&&(e.\u0275\u0275elementStart(0,"div",45),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.error," ")}}function E(n,i){1&n&&(e.\u0275\u0275elementStart(0,"div",46),e.\u0275\u0275text(1," Your data was successfully updated ! "),e.\u0275\u0275elementEnd())}function N(n,i){if(1&n&&(e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275template(1,P,4,0,"div",34),e.\u0275\u0275template(2,S,10,1,"div",35),e.\u0275\u0275template(3,M,2,1,"div",36),e.\u0275\u0275template(4,E,2,0,"div",37),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.loading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.loading&&""==t.success&&""==t.error),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.loading&&""!=t.error),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.loading&&""!=t.success)}}const I=function(n){return{"background-image":n,"background-size":"cover"}},O=[{path:"",component:(()=>{class n{constructor(t,r,l,a){this.authService=t,this.fb=r,this.modalService=l,this.profileServ=a,this.profile=null,this.pswd="",this.error="",this.success="",this.isFile=!1,this.file=null,this.loading=!1,this.credentials_roles={admin:[{name:"Changer le nom",formCtrl:"lastName",displayed:!1},{name:"Changer le prenom",formCtrl:"firstName",displayed:!1},{name:"Changer l'email",formCtrl:"email",displayed:!1},{name:"Changer le profile",formCtrl:"profile",displayed:!1},{name:"Changer le mot de passe",formCtrl:"password",displayed:!1}],responsable:[{name:"Changer le nom",formCtrl:"nom",displayed:!1},{name:"Changer le prenom",formCtrl:"prenom",displayed:!1},{name:"Changer l'email",formCtrl:"email",displayed:!1},{name:"Changer le service",formCtrl:"service",displayed:!1},{name:"Changer le num\xe9ro de t\xe9l\xe9phone",formCtrl:"numeroTelephone",displayed:!1},{name:"Changer le mot de passe",formCtrl:"password",displayed:!1}]},this.credentials_list=null}ngOnInit(){this.profileServ.userEmitter.subscribe(t=>{switch(this.role){case"Admin":this.profile={firstName:t.firstName,lastName:t.lastName,imgUrl:t.imgUrl};break;case"Responsable":this.profile={firstName:t.prenom,lastName:t.nom,imgUrl:t.imgUrl}}}),this.authService.adminEmitter.pipe((0,c.q)(1)).subscribe(t=>{t?this.profile={firstName:t.firstName,lastName:t.lastName,imgUrl:t.imgUrl}:this.authService.responsableEmitter.pipe((0,c.q)(1)).subscribe(r=>{r&&(this.profile={firstName:r.firstName,lastName:r.lastName,imgUrl:r.imgUrl})})}),this.authService.connectedRole.pipe((0,c.q)(1)).subscribe(t=>{this.role=t,console.log("this is the role : ",this.role),this.initCredentialsList()})}initCredentialsList(){switch(this.role){case"Admin":this.credentials_list=this.credentials_roles.admin;break;case"Responsable":this.credentials_list=this.credentials_roles.responsable}}toggleDisplay(t){this.credentials_list=this.credentials_list.map(r=>r.name===t.name?(r.displayed||this.initForm(r.formCtrl),Object.assign(Object.assign({},r),{displayed:!r.displayed})):Object.assign(Object.assign({},r),{displayed:!1}))}initForm(t){if("password"!==t)switch(t){case"lastName":this.inputForm=new o.cw({lastName:new o.NI("")});break;case"firstName":this.inputForm=new o.cw({firstName:new o.NI("")});break;case"email":this.inputForm=new o.cw({email:new o.NI("")});break;case"numeroTelephone":this.inputForm=new o.cw({numeroTelephone:new o.NI("")});break;case"nom":this.inputForm=new o.cw({nom:new o.NI("")});break;case"prenom":this.inputForm=new o.cw({prenom:new o.NI("")});break;case"service":this.inputForm=new o.cw({service:new o.NI("")})}else this.inputForm=new o.cw({password:new o.NI("",[o.kI.minLength(12),o.kI.maxLength(20)]),confirmation:new o.NI("",o.kI.required)},{validators:l=>{const a=l.get("password"),m=l.get("confirmation");return a.value!==m.value&&m.setErrors({notmatched:!0}),(null==a?void 0:a.value)===(null==m?void 0:m.value)?null:{notmatched:!0}}})}showModal(t){this.modalService.open(t,{size:"lg",centered:!0,windowClass:"authModal"})}onUpload(t,r){return(0,g.mG)(this,void 0,void 0,function*(){this.file=t.target.files[0],this.success="",this.error="",""==this.pswd&&this.showModal(r)})}uploadPic(){return(0,g.mG)(this,void 0,void 0,function*(){this.loading=!0;const t=yield this.profileServ.uploadProfilePic(this.file);this.profileServ.updateProfile({imgUrl:t},this.pswd,this.role).subscribe(r=>{console.log("done"),this.pswd="",this.success="updated",this.loading=!1,this.file=null,this.profileServ.getUserCredetials(this.role)},r=>{this.pswd="",this.loading=!1,this.isFile=!1,this.file=null,console.log(r),this.error=r.error.message})})}onSubmit(t){this.success="",this.error="",""==this.pswd?this.showModal(t):(this.loading=!0,this.profileServ.updateProfile(this.inputForm.value,this.pswd,this.role).subscribe(r=>{console.log("done"),this.pswd="",this.success="updated",this.loading=!1,this.profileServ.getUserCredetials(this.role)},r=>{this.pswd="",this.loading=!1,console.log(r),this.error=r.error.message}))}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(u.BR),e.\u0275\u0275directiveInject(o.qu),e.\u0275\u0275directiveInject(_.FF),e.\u0275\u0275directiveInject(h.H))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-profile"]],decls:20,vars:6,consts:[[1,"profile"],[1,"profile__header"],[1,"profile__pic",3,"ngStyle","click"],["type","file",2,"display","none",3,"change"],["fileInput",""],[1,"overlay"],[1,"icon"],["src","https://cdn-icons-png.flaticon.com/512/83/83574.png","alt","camera__icon",1,"icon__img"],[1,"profile__fullname"],[1,"firstName"],[1,"lastName"],[1,"body"],[1,"credentials__list"],["class","credentials__item",4,"ngFor","ngForOf"],[1,"modal","enterPassword"],["enterPassword",""],[1,"credentials__item"],[1,"credential","d-flex","justify-content-between"],[1,"arrows",3,"ngStyle","click"],["class","arrow arrow__down",4,"ngIf"],["class","arrow arrow__top",4,"ngIf"],["class","content ",4,"ngIf"],[1,"arrow","arrow__down"],[1,"arrow","arrow__top"],[1,"content"],[1,"mt-0",3,"formGroup","ngSubmit"],[1,"mb-3","mt-0"],[1,"form-label",3,"for"],[1,"form-control",3,"type","id","formControlName"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-success","mt-2",3,"disabled"],[1,"mb-3"],["type","password","formControlName","confirmation",1,"form-control",3,"id"],[1,"modal-body"],["class","d-flex flex-column justify-content-center align-items-center",4,"ngIf"],["class","notConnected",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","alert alert-success","role","alert",4,"ngIf"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],[1,"text-primary","text-md","mt-1","mt-2"],[1,"lds-dual-ring"],[1,"notConnected"],["for","pswd"],["type","password",1,"form-control",3,"ngModel","ngModelChange"],[1,"authentifier","btn","mt-4",2,"background-color","#5590ea","color","white",3,"click"],["role","alert",1,"alert","alert-danger"],["role","alert",1,"alert","alert-success"]],template:function(t,r){if(1&t){const l=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(l),e.\u0275\u0275reference(4).click()}),e.\u0275\u0275elementStart(3,"input",3,4),e.\u0275\u0275listener("change",function(m){e.\u0275\u0275restoreView(l);const j=e.\u0275\u0275reference(19);return r.onUpload(m,j)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"div",5),e.\u0275\u0275elementStart(6,"div",6),e.\u0275\u0275element(7,"img",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",8),e.\u0275\u0275elementStart(9,"h2"),e.\u0275\u0275elementStart(10,"span",9),e.\u0275\u0275text(11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"span",10),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",11),e.\u0275\u0275elementStart(15,"ul",12),e.\u0275\u0275template(16,b,8,7,"li",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",14),e.\u0275\u0275template(18,N,5,4,"ng-template",null,15,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()}2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(4,I," url("+(null==r.profile?null:r.profile.imgUrl)+")")),e.\u0275\u0275advance(9),e.\u0275\u0275textInterpolate1("",r.profile.firstName," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.profile.lastName,""),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.credentials_list))},directives:[d.NgStyle,d.NgForOf,d.NgIf,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,o.On],styles:['.profile[_ngcontent-%COMP%]{width:90%;margin:.5rem;height:80vh;border-radius:12px;padding:1rem;box-shadow:0 .7rem 2rem #0000001a;background-color:#fff;overflow-y:auto}.profile__header[_ngcontent-%COMP%]{display:flex}.profile__pic[_ngcontent-%COMP%]{width:6.25rem;height:6.25rem;border-radius:50px;position:relative;cursor:pointer}.profile__pic[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{width:6.25rem;height:6.25rem;border-radius:50px;position:absolute;top:0;left:0;background-color:#fff9;display:none;transition:all .6s;z-index:100}.profile__pic[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:.9rem;height:.9rem;position:absolute;top:50%;left:50%;z-index:200;transform:translate(-50%,-50%);display:none;transition:all .6s}.profile__pic[_ngcontent-%COMP%]   .icon__img[_ngcontent-%COMP%]{width:100%}.profile__pic[_ngcontent-%COMP%]:hover   .overlay[_ngcontent-%COMP%], .profile__pic[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{display:block}.profile__fullname[_ngcontent-%COMP%]{margin:1.9rem 1.5rem;font-size:1rem;font-family:Raleway Regular}.profile__fullname[_ngcontent-%COMP%]   .firstName[_ngcontent-%COMP%]{text-transform:capitalize;font-weight:700}.profile__fullname[_ngcontent-%COMP%]   .lastName[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:700}.arrows[_ngcontent-%COMP%]{font-size:1.6rem;cursor:pointer;font-weight:bolder;color:#d0d0d0;height:auto;padding:0!important}.arrows[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{padding-top:0!important}.arrows[_ngcontent-%COMP%]   .arrow__top[_ngcontent-%COMP%]{font-size:1.2rem}.credentials__list[_ngcontent-%COMP%]{list-style:none;padding:1rem;margin:.6rem 0}.credential[_ngcontent-%COMP%]{font-family:Raleway Regular;font-size:1rem;padding:.8rem;margin:1rem;color:#000;font-weight:700;border-bottom:1px solid rgba(216,216,216,.79)}.content[_ngcontent-%COMP%]{margin:0!important}.modal-body[_ngcontent-%COMP%]{padding:3rem!important}.modal-body[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#2b2b2b;font-size:1.1rem;font-family:Raleway;text-transform:uppercase;margin-bottom:3rem}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:justify;color:#2b2b2b;font-size:.8rem;font-family:Raleway;margin-bottom:2rem}.lds-dual-ring[_ngcontent-%COMP%]{display:inline-block;width:80px;height:80px}.lds-dual-ring[_ngcontent-%COMP%]:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:6px solid #556ee6;border-color:#556ee6 transparent #556ee6 transparent;-webkit-animation:lds-dual-ring 1.2s linear infinite;animation:lds-dual-ring 1.2s linear infinite}@-webkit-keyframes lds-dual-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes lds-dual-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']}),n})()}];let k=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[f.Bz.forChild(O)],f.Bz]}),n})();var F=s(40520);let T=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[d.CommonModule,k,o.UX,o.u5,F.JF]]}),n})()}}]);